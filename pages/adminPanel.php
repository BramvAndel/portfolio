<?php
session_start();
if (!isset($_SESSION['username'])) {
    header('Location: ./login.php');
    exit();
}
include '../database/database.php';

$stmt = $conn->prepare("SELECT * FROM projects");
$stmt->execute();
$projects = $stmt->fetchAll(PDO::FETCH_ASSOC);
?>

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>admin panel</title>
    <link rel="stylesheet" href="../assets/css/general.css">
    <link rel="stylesheet" href="../assets/css/fonts.css">
    <link rel="stylesheet" href="../assets/css/adminPanel.css">
    <script src="../assets/js/header.js" defer></script>
    <script src="../assets/js/script.js" defer></script>
    <script src="../assets/js/navbar.js" defer></script>
</head>

<body>
    <?php include '../templates/header.tpl.php' ?>
    <main>
        <div class="panel">
            <div class="projectList">
                <?php if (count($projects) > 0): ?>
                    <?php foreach ($projects as $project): ?>
                        <div class="project">
                            <a class="projectInfo" href="./editProject.php?project_id=<?php echo htmlspecialchars($project['id']); ?>" data-projectID="<?php echo htmlspecialchars($project['id']); ?>">
                                <div class="projectTitleDiv">
                                    <svg width="41" height="42" viewBox="0 0 41 42" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M20.5 17.8728C19.5785 17.8728 18.6947 18.2389 18.0431 18.8905C17.3915 19.5421 17.0254 20.4259 17.0254 21.3474C17.0254 22.2689 17.3915 23.1527 18.0431 23.8043C18.6947 24.4559 19.5785 24.822 20.5 24.822C22.4284 24.822 23.9745 23.2758 23.9745 21.3474C23.9745 20.4259 23.6085 19.5421 22.9569 18.8905C22.3053 18.2389 21.4215 17.8728 20.5 17.8728Z" />
                                    </svg>
                                    <h2><?php echo htmlspecialchars($project['title']); ?></h2>
                                    <svg width="41" height="42" viewBox="0 0 41 42" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M20.5 17.8728C19.5785 17.8728 18.6947 18.2389 18.0431 18.8905C17.3915 19.5421 17.0254 20.4259 17.0254 21.3474C17.0254 22.2689 17.3915 23.1527 18.0431 23.8043C18.6947 24.4559 19.5785 24.822 20.5 24.822C22.4284 24.822 23.9745 23.2758 23.9745 21.3474C23.9745 20.4259 23.6085 19.5421 22.9569 18.8905C22.3053 18.2389 21.4215 17.8728 20.5 17.8728Z" />
                                    </svg>
                                </div>
                                <p class="projectDate"><?php echo htmlspecialchars(date('d-m-Y', strtotime($project['project_date']))); ?></p>
                            </a>
                            <div class="projectButtons">
                                <a href="./editProject.php?project_id=<?php echo htmlspecialchars($project['id']); ?>" class="projectButton" data-projectID="<?php echo htmlspecialchars($project['id']); ?>">
                                    <svg width="50" height="50" viewBox="0 0 50 50" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M43.1458 14.6665C43.9583 13.854 43.9583 12.4998 43.1458 11.729L38.2708 6.854C37.5 6.0415 36.1458 6.0415 35.3333 6.854L31.5 10.6665L39.3125 18.479M6.25 35.9373V43.7498H14.0625L37.1042 20.6873L29.2917 12.8748L6.25 35.9373Z" />
                                    </svg>
                                </a>
                                <a href="../includes/deleteProject.inc.php?project_id=<?php echo htmlspecialchars($project['id']); ?>" class="projectButton" onclick="return confirm('Are you sure you want to delete this project?');">
                                    <svg width="50" height="50" viewBox="0 0 50 50" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M39.5837 8.33333H32.292L30.2087 6.25H19.792L17.7087 8.33333H10.417V12.5H39.5837M12.5003 39.5833C12.5003 40.6884 12.9393 41.7482 13.7207 42.5296C14.5021 43.311 15.5619 43.75 16.667 43.75H33.3337C34.4387 43.75 35.4985 43.311 36.2799 42.5296C37.0613 41.7482 37.5003 40.6884 37.5003 39.5833V14.5833H12.5003V39.5833Z" />
                                    </svg>
                                </a>
                            </div>
                        </div>
                    <?php endforeach; ?>
                <?php else: ?>
                    <p>No projects found.</p>
                <?php endif; ?>
            </div>
            <div class="panelButtons">
                <a href="./addProject.php" class="addProjectButton">
                    <svg width="50" height="50" viewBox="0 0 50 50" xmlns="http://www.w3.org/2000/svg">
                        <path d="M39.5837 27.0792H27.0837V39.5792H22.917V27.0792H10.417V22.9125H22.917V10.4125H27.0837V22.9125H39.5837V27.0792Z" />
                    </svg>
                </a>
                <a href="https://web03.sd-lab.nl:8443/" target="_blank">
                    <svg width="50" height="50" viewBox="0 0 50 50" xmlns="http://www.w3.org/2000/svg">
                        <g clip-path="url(#clip0_521_757)">
                            <path d="M12.7125 14.6271V29.9458H14.2458V14.625L12.7125 14.6271ZM41.1604 14.6479V29.9458H42.6917V14.65L41.1604 14.6479ZM42.6917 24.3L47.8563 29.9458H49.9792L44.6167 24.2562L50 19.0042H47.9437L42.6917 24.3ZM34.3417 18.8083C33.2264 18.8083 32.3167 19.0708 31.6125 19.5958C30.9111 20.1208 30.5604 20.8639 30.5604 21.825C30.5604 22.3667 30.6632 22.8125 30.8687 23.1625C31.0771 23.5125 31.341 23.8007 31.6604 24.0271C31.9812 24.2535 32.3438 24.4389 32.7479 24.5833C33.1507 24.7306 33.5604 24.8625 33.9771 24.9792C34.3424 25.0819 34.6896 25.1875 35.0187 25.2958C35.3479 25.4042 35.6382 25.5389 35.8896 25.7C36.129 25.8461 36.3326 26.044 36.4854 26.2792C36.6312 26.5056 36.7035 26.7868 36.7021 27.1229C36.7021 27.5604 36.5035 27.9319 36.1062 28.2375C35.7104 28.5431 35.0993 28.6965 34.2729 28.6979C33.0049 28.6979 31.9736 28.1875 31.1792 27.1667L29.9875 28.2167C30.5833 28.8722 31.2174 29.3431 31.8896 29.6292C32.5618 29.9125 33.3326 30.0542 34.2021 30.0542C34.7687 30.0542 35.3007 29.9847 35.7979 29.8458C36.2628 29.722 36.7012 29.5144 37.0917 29.2333C37.4583 28.9639 37.7493 28.6319 37.9646 28.2375C38.1771 27.8444 38.2833 27.4 38.2833 26.9042C38.2833 26.3639 38.1771 25.9153 37.9646 25.5583C37.7486 25.2028 37.4639 24.894 37.1271 24.65C36.7774 24.3992 36.3955 24.1967 35.9917 24.0479C35.5827 23.8956 35.17 23.7532 34.7542 23.6208C34.4181 23.5181 34.0938 23.4125 33.7812 23.3042C33.4924 23.207 33.215 23.0785 32.9542 22.9208C32.7286 22.7878 32.5335 22.6089 32.3812 22.3958C32.2321 22.1771 32.1562 21.9167 32.1646 21.6521C32.1646 21.2299 32.3208 20.8799 32.6333 20.6021C32.9458 20.3243 33.4924 20.1854 34.2729 20.1854C34.884 20.1854 35.4111 20.2986 35.8542 20.525C36.2972 20.7514 36.7097 21.1056 37.0917 21.5875L37.1146 21.6083L38.2396 20.5792C37.6729 19.9236 37.0806 19.4646 36.4625 19.2021C35.7892 18.9293 35.068 18.7967 34.3417 18.8083ZM3.74167 18.8938C2.51667 18.8938 1.26944 19.091 0 19.4854V35.3729H1.51042V29.7062C1.88958 29.8062 2.26875 29.8861 2.64792 29.9458C3.75244 30.1209 4.88231 30.0426 5.95208 29.7167C6.65208 29.5042 7.27569 29.1722 7.82292 28.7208C8.37014 28.2681 8.8118 27.6917 9.14792 26.9917C9.48125 26.2917 9.64861 25.4528 9.65 24.475C9.65 23.6736 9.51111 22.9299 9.23333 22.2437C8.96847 21.5738 8.56197 20.9691 8.04167 20.4708C7.50406 19.96 6.8673 19.5651 6.17083 19.3104C5.39282 19.0263 4.56988 18.8852 3.74167 18.8938ZM22.2542 18.8938C21.5833 18.8938 20.9486 19.0069 20.35 19.2333C19.7514 19.4611 19.2264 19.8083 18.775 20.275C18.299 20.7809 17.9335 21.3804 17.7021 22.0354C17.4396 22.7437 17.3083 23.5785 17.3083 24.5396C17.3083 25.2688 17.4174 25.9618 17.6354 26.6188C17.8562 27.2757 18.1847 27.859 18.6208 28.3687C19.0583 28.8812 19.6056 29.2861 20.2625 29.5833C20.9194 29.8833 21.6854 30.0333 22.5604 30.0333C23.509 30.0333 24.3187 29.891 24.9896 29.6063C25.6604 29.3215 26.2507 28.9021 26.7604 28.3479L25.8437 27.3854C25.4531 27.8283 24.9664 28.176 24.4208 28.4021C23.8639 28.6216 23.2694 28.7299 22.6708 28.7208C21.5167 28.7208 20.6042 28.3556 19.9333 27.625C19.2625 26.8958 18.9056 25.9118 18.8625 24.6729H27.0687C27.0965 22.7896 26.7021 21.3563 25.8854 20.3729C25.0688 19.3868 23.8583 18.8938 22.2542 18.8938ZM22.3188 20.1854C22.8604 20.1854 23.3347 20.2694 23.7417 20.4375C24.15 20.6042 24.4819 20.8264 24.7375 21.1042C24.9917 21.3819 25.1889 21.7181 25.3292 22.1125C25.4694 22.5069 25.5389 22.9299 25.5375 23.3812H18.9042C19.0182 22.532 19.3756 21.7339 19.9333 21.0833C20.1653 20.8194 20.4819 20.6042 20.8833 20.4375C21.2847 20.2708 21.7625 20.1875 22.3167 20.1875L22.3188 20.1854ZM3.875 20.2083C5.15833 20.2083 6.15417 20.5993 6.8625 21.3812C7.57083 22.1604 7.925 23.1847 7.925 24.4542C7.925 25.8278 7.54167 26.8819 6.775 27.6167C6.00833 28.3528 4.97639 28.7208 3.67917 28.7208C3.32917 28.7208 2.96806 28.6812 2.59583 28.6021C2.22967 28.523 1.86803 28.4243 1.5125 28.3062V20.5583C1.88966 20.4299 2.27823 20.3378 2.67292 20.2833C3.07183 20.2352 3.47319 20.2101 3.875 20.2083ZM8.82708 33.9333V35.375H18.0417V33.9333H8.82708Z" fill="#1E1E1E" />
                        </g>
                        <defs>
                            <clipPath id="clip0_521_757">
                                <rect width="50" height="50" />
                            </clipPath>
                        </defs>
                    </svg>
                </a>
            </div>
        </div>
    </main>
    <div id=" backgroundImage">
    </div>
    <?php include '../templates/footer.tpl.php' ?>
</body>

</html>